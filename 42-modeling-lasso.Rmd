---
title: "42-modeling-Lasso"
output: html_notebook
---

The purpose of this document is to build bootstrap training data n number of times and train n different lasso models and extract
Steps taken the same with random forest


```{r lasso logistic model function}
lasso_feature_selection <- function(training_df,
                                    n = 2,
                                    k = 5,
                                    lambda_tune = seq(0,0.02,0.002),
                                    outcome,
                                    top_n = 20){
  # training_df : training data frame sent in after initial 70-30 split
  # n : n number of bootstrapped
  # k : k folds in cross-validation
  # lambda_tune : tuning parameters to test for lambda
  # outcome : name of the outcome variable
  # top_n : top n important variables to be extracted from the models generated
  # return : a list of three lists: 
  #          list 1 - all models created
  #          list 2 - all model performances
  #          list 3 - all dataframes of variable importances with the top_n variables in it

  

  #create bootstraps list
  straps <- training_df %>%bootstraps(times = n, strata = outcome)
  
  #lists to store results and models that are created on each bootstrap
  combined_models <- list()
  combined_performances <- list()
  variable_imps <- list()
  
  
  # Train the model on each of the bootstraps and get the performance 
  for(i in 1:length(straps$splits)){
    results <- as.data.frame(straps$splits[[i]])%>%
      boot_model_lasso(outcome = outcome, lambda_tune = lambda_tune, nfolds = k)
    
    combined_models[[i]] <- results[[1]]
    combined_performances[[i]] <- results[[2]]
    variable_imps[[i]] <- get_top_n_names(results[[1]], 20)
    
  }
  
  
  
  
  return(list(combined_models, combined_performances, variable_imps))



}
```


```{r}
lasso_feature_selection(training_df,outcome = "h5mn8")
```

