---
title: "21-explore-depression"
output: html_notebook
---

## Missing Value Visualization for Depression
* All the missing values are from wave 5.
```{r}
depression %>% 
  gg_miss_var(show_pct = T)
```

```{r}
diag_depression %>% 
  gg_miss_var(show_pct = T)
```

```{r}
hist_by_var <-function(df,vars, title = title){
  ggplot(gather(df[,which(colnames(df) %in% vars)]), aes(x= value)) + 
    geom_bar(stat = 'count') + 
    facet_wrap(~key, scales = 'free_x')+
    ggtitle(title)+
    theme_minimal()+
    theme(plot.title=element_text(hjust=0.5))
}
```



# Depression Variables
Visualization of how answers change for the same question over different waves.
```{r}

p1 <- hist_by_var(depression, c('h1fs1',"h3sp5","h4mh18"), "bothered by things")
p2 <- hist_by_var(depression, c("h1fs3","h3sp6","h4mh19","h5ss0a"), "shake off blues")
p3 <- hist_by_var(depression, c("h1fs4","h3sp7","h4mh20"), "felt as good as others")
p4 <- hist_by_var(depression, c("h1fs5","h3sp8","h4mh21"), "trouble concentrating")
p5 <- hist_by_var(depression, c("h1fs6","h3sp9","h4mh22",	"h5ss0b"), "felt depressed")
p6 <- hist_by_var(depression, c("h1fs7","h3sp10",	"h4mh23"), "felt too tired")
p7 <- hist_by_var(depression, c("h1fs11","h4mh24","h5ss0c"), "felt happy")
p8 <-hist_by_var(depression, c("h1fs15","h3sp11","h4mh25"), "enjoyed life")
p9 <-hist_by_var(depression, c("h1fs16","h3sp12","h4mh26","h5ss0d"), "felt sad")
p10 <- hist_by_var(depression, c("h1fs17","h3sp13","h4mh27"), "felt disliked")
grid.arrange(p1, p2, p3, p4, p5, p6, nrow = 2)
grid.arrange(p7, p8, p9, p10, nrow = 2)             
          
```

### Visualization of Wave 1 Variables and Survey Answers for those
* Only the first one h1fs1 has range 0,1,2,3,4,5,6,8,9
0	never or rarely
1	sometimes
2	a lot of the time	
3	most of the time or all of the time	
6	refused	
8	don't know	
9	not applicable

* Other ones have range 0,1,2,3,6,8
0	never or rarely	
1	sometimes	
2	a lot of the time	
3	most of the time or all of the time	
6	refused	
8	don't know

```{r}
depression_wave1 <- depression %>% 
  dplyr::select(h1fs3,h1fs4,h1fs5,h1fs6,h1fs7,h1fs11,h1fs15,h1fs16,h1fs17)

depression_wave1_sub <- depression %>% 
  dplyr::select(h1fs1)


p1 <- plot(likert(data.frame(depression_wave1)),
     type="heat",
           low.color = "white",
           high.color = "blue",
           text.color = "black",
           text.size = 2.5,
           wrap = 50)

p2 <- plot(likert(data.frame(depression_wave1_sub)),
     type="heat",
           low.color = "white",
           high.color = "blue",
           text.color = "black",
           text.size = 2.5,
           wrap = 50)

grid.arrange(p1, p2, nrow = 2)

#                           labels=c("never\nor rarely","sometimes","a lot of\nthe time",
#                                    "most of the\ntime or all\nof the time","refused","don't know")))

```
#### Visualization of Wave 3 Variables and Survey Answers for those

Survey scale toward variables:
0	never or rarely
1	sometimes	
2	a lot of the time	
3	most of the time or all of the time	
6	refused	
8	don't know
9	not applicable
```{r}
depression_wave3 <- depression %>% 
  dplyr::select(h3sp5,h3sp6,h3sp7,h3sp8,h3sp9,h3sp10,h3sp11,h3sp12,h3sp13)


plot(likert(data.frame(depression_wave3)),
     type="heat",
           low.color = "white",
           high.color = "blue",
           text.color = "black",
           text.size = 3.5,
           wrap = 50)+
  ggtitle("Wave 3 Depression Related Survey Answers")+
  theme_minimal()+
  theme(plot.title=element_text(hjust=0.5))

```
#### Visualization of Wave 4 Variables and Survey Answers for those
h4mh22:
0	never or rarely
1	sometimes	
2	a lot of the time	
3	most of the time or all of the time	
6	refused	
8	don't know	
```{r}

depression_wave4 <- depression%>% 
  dplyr::select(h4mh18, h4mh19, h4mh20,h4mh21,h4mh22,h4mh23,h4mh24,h4mh25,h4mh26,h4mh27) 

plot(likert(as.data.frame(depression_wave4)),
     type="heat",
     low.color = "white",
     high.color = "blue",
     text.color = "black",
     text.size = 3.5,
     wrap = 50,
     plot.percent = F) +
  ggtitle("Wave 4 Depression Related Survey Answers")+
  theme_minimal()+
  theme(plot.title=element_text(hjust=0.5))

#Labels for the answers 
#("never or\nrarely","sometimes","a lot of\nthe time","most of the\ntime or all\nof the time","refused","don't\nknow"

```
#### Visualization of Wave 5 Variables and Survey Answers for those
```{r}
depression_wave5 <- depression %>% 
  dplyr::select(h5ss0a,h5ss0b,h5ss0c,h5ss0d)

plot(likert(data.frame(depression_wave5)),
     type="heat",
           low.color = "white",
           high.color = "blue",
           text.color = "black",
           text.size = 4,
           wrap = 50) +
  ggtitle("Wave 5 Depression Related Survey Answers")+
  theme_minimal()+
  theme(plot.title=element_text(hjust=0.5))
  

```



# Diagnosed Depression Variables

```{r}

ggplot(gather(diag_depression[,2:3]), aes(x= value)) + 
    geom_bar(stat = 'count') + 
    facet_wrap(~key, scales = 'free_x')
```

# Description of the Two Datasets

## Description of Depression Subsets
This description is for the responses to the following questions:
bothered by things
shake off blues
felt as good as others
trouble concentrating
felt depressed
felt too tired
felt happy
enjoyed life
felt sad
felt disliked

* Notice that some are ranging 0,1,2,3,6,8,9, and some are ranging 0,1,2,3,6,8
```{r}
describe(depression)
```


## Description of Diagnosed Depression
```{r}
describe(diag_depression)
```

