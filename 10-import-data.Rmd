---
title: "10-import-data"
output: html_notebook
---

# Data

All data is structured. Source files are all SAS export files. This is a large dataset, collected in waves. The most recent is Wave 5, which includes the outcomes.

# Libraries
```{r}
# install.packages("SASxport")
library(SASxport)
library(haven)
library(plyr)
library(dplyr)
library(tidyr)
# library(vroom)
library(janitor)
library(naniar)
library(ggplot2)
library(Hmisc)
library(purrr)
library(scales)
library(reshape)
library(HH)
library(tibble)
library(likert)
library(reshape2)
```

# Importing The Waves

Instructions:
Run below chunk and select all the wave files you wish you import.

```{r}
files <- choose.files(default = "", caption = "Select files",
             multi = TRUE, filters = Filters,
             index = nrow(Filters))

for (i in 1:length(files)){
  assign(paste0('wave',i), read_xpt(files[i]))
}
```


# Joined Data

Note:
Skipping wave 2 as it is not needed for analysis

```{r}
joined_waves <- wave1 %>%
    #inner_join(wave2, by = "AID") %>%
    inner_join(wave3, by = "AID") %>%
    inner_join(wave4, by = "AID") %>%
    inner_join(wave5, by = "AID")

```

9349 observations remaining after inner joining on AID and 6576 variables. 

```{r}
joined_waves <- joined_waves %>% 
  clean_names()
```


# Check the exsit of one variable 
```{r}
# Such as 

c("H2FS1") %in% names(joined_waves)


```


# Combined Anxiety, Optimism and Depression 
```{r}
# c4var009 for anxiety not exist.
# c4var010 for optimism not exist.
predictor_vars <- joined_waves %>%
  dplyr::select(aid, 
         h4id5j,
         #c4var009,
         h4pe6,
         h4pe14,
         h4pe22,
         h4pe30,
         #c4var010,
         h4pe7,
         h4pe15,
         h4pe23,
         h4pe31,
         h5id6i,
         h5pe1,
         h5pe2,
         h5pe3,h1fs1,h3sp5,h4mh18,h1fs3,
         h3sp6,h4mh19,h5ss0a,h1fs4,h3sp7,
         h4mh20,h1fs5,h3sp8	,h4mh21,h1fs6,
         h3sp9,h4mh22,h5ss0b,h1fs7,	
         h3sp10,h4mh23,h1fs11,h4mh24,
         h5ss0c,h1fs15,h3sp11,h4mh25,
         h1fs16,h3sp12,h4mh26,h5ss0d,h1fs17,
         h3sp13,h4mh27,h4id5h,h5id6g
         #,c4var002
         ) 


```

# Anxiety Variables
```{r}
anxiety <- predictor_vars %>%
  dplyr::select(aid,h4pe6,h4pe14,h4pe22,h4pe30,h4id5j, h5id6i)

```


# Optimism Variables
```{r}
optimism <- predictor_vars %>%
  dplyr::select(h4pe7,h5pe1,h4pe15,h5pe2,h4pe23,h5pe3,h4pe31)

```


# Depression Variables
Variables for answers to questions of diagnosed depression and CESD measures.
```{r}

depression <- predictor_vars %>%
  dplyr::select(h1fs1,h1fs3,h1fs4,h1fs5,h1fs6,h1fs7,h1fs11,h1fs15,h1fs16,h1fs17,
h3sp5,h4mh18,h3sp6,h4mh19,h5ss0a,h3sp7,h4mh20,h3sp8,h4mh21,h3sp9,h4mh22,h5ss0b,h3sp10,h4mh23,h4mh24,h5ss0c,h3sp11,h4mh25,h3sp12,h4mh26,h5ss0d,h3sp13,h4mh27,h4id5h,h5id6g)

```


# Suicide Ideation Variables

```{r}
suicide <- joined_waves %>% 
  select(aid,h1su1,h3to130,h4se1,h5mn8)

```


# Marijuana Use Variables

```{r}
marijuana <- joined_waves %>% 
  select(aid,h1to32,h3to110,h4to71,h5to21)
```





## Data Description/ Fields

Measures used:

Dependent variables: diseases of despair, including suicidal ideation, heavy/problem drinking, drug use, DSM-IV criteria for alcohol, marijuana, and other drug abuse and dependence
*	Suicidal ideation at Wave IV
    +	Thoughts of suicide in the last 12 months
*	Alcohol use at Wave IV
    +	Days drank alcohol in last 12 months
    +	Drinks each time in last 12 months
    +	Days drank alcohol in last 3 months
    +	Drinks each time in last 3 months
    +	Occasions of more than 4/5 drinks in a row in last 12 months
    +	DSM4 lifetime diagnosis of alcohol abuse or dependence
*	Marijuana use at Wave IV
    +	Times used in last 30 days
    +	DSM4 lifetime diagnosis of cannabis abuse or dependence
*	Illegal drug use at Wave IV
    +	DSM4 lifetime diagnosis of other drug use/dependence
    +	Lifetime use of cocaine, crystal meth, heroin, other illegal drugs (separately)
*	Prescription drug abuse at Wave IV
    +	Lifetime use of sedatives, tranquilizers, stimulants, painkillers (separately)

Key independent variables: measures of cognitive and emotional despair
*	Cognitive despair
    +	Wave III personality measures of self-consciousness, persistence
*	Emotional despair
    +	Wave I – III CES-D items

Other variables: 
*	Demographic controls for age at Wave IV, sex, race/ethnicity
*	Wave I – III predictors
